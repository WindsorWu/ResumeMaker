import{R as oe,r as P}from"./vendor-BJAOCLFF.js";const D={},k=(e,n)=>e.unstable_is?e.unstable_is(n):n===e,B=e=>"init"in e,C=e=>!!e.write,m=e=>"v"in e||"e"in e,x=e=>{if("e"in e)throw e.e;if((D?"production":void 0)!=="production"&&!("v"in e))throw new Error("[Bug] atom state is not initialized");return e.v},J=new WeakMap,H=e=>{var n;return j(e)&&!!((n=J.get(e))!=null&&n[0])},ve=e=>{const n=J.get(e);n?.[0]&&(n[0]=!1,n[1].forEach(t=>t()))},ie=(e,n)=>{let t=J.get(e);if(!t){t=[!0,new Set],J.set(e,t);const o=()=>{t[0]=!1};e.then(o,o)}t[1].add(n)},j=e=>typeof e?.then=="function",se=(e,n,t)=>{t.p.has(e)||(t.p.add(e),n.then(()=>{t.p.delete(e)},()=>{t.p.delete(e)}))},G=(e,n,t)=>{const o=t(e),i="v"in o,a=o.v;if(j(n))for(const f of o.d.keys())se(e,n,t(f));o.v=n,delete o.e,(!i||!Object.is(a,o.v))&&(++o.n,j(a)&&ve(a))},ee=(e,n,t)=>{var o;const i=new Set;for(const a of((o=t.get(e))==null?void 0:o.t)||[])t.has(a)&&i.add(a);for(const a of n.p)i.add(a);return i},_e=()=>{const e=new Set,n=()=>{e.forEach(t=>t())};return n.add=t=>(e.add(t),()=>{e.delete(t)}),n},K=()=>{const e={},n=new WeakMap,t=o=>{var i,a;(i=n.get(e))==null||i.forEach(f=>f(o)),(a=n.get(o))==null||a.forEach(f=>f())};return t.add=(o,i)=>{const a=o||e,f=(n.has(a)?n:n.set(a,new Set)).get(a);return f.add(i),()=>{f?.delete(i),f.size||n.delete(a)}},t},we=e=>(e.c||(e.c=K()),e.m||(e.m=K()),e.u||(e.u=K()),e.f||(e.f=_e()),e),he=Symbol(),Se=(e=new WeakMap,n=new WeakMap,t=new WeakMap,o=new Set,i=new Set,a=new Set,f={},h=(S,...y)=>S.read(...y),w=(S,...y)=>S.write(...y),s=(S,y)=>{var g;return(g=S.unstable_onInit)==null?void 0:g.call(S,y)},v=(S,y)=>{var g;return(g=S.onMount)==null?void 0:g.call(S,y)},...p)=>{const S=p[0]||(r=>{if((D?"production":void 0)!=="production"&&!r)throw new Error("Atom is undefined or null");let _=e.get(r);return _||(_={d:new Map,p:new Set,n:0},e.set(r,_),s?.(r,U)),_}),y=p[1]||(()=>{const r=[],_=d=>{try{d()}catch(u){r.push(u)}};do{f.f&&_(f.f);const d=new Set,u=d.add.bind(d);o.forEach(c=>{var l;return(l=n.get(c))==null?void 0:l.l.forEach(u)}),o.clear(),a.forEach(u),a.clear(),i.forEach(u),i.clear(),d.forEach(_),o.size&&g()}while(o.size||a.size||i.size);if(r.length)throw new AggregateError(r)}),g=p[2]||(()=>{const r=[],_=new WeakSet,d=new WeakSet,u=Array.from(o);for(;u.length;){const c=u[u.length-1],l=S(c);if(d.has(c)){u.pop();continue}if(_.has(c)){if(t.get(c)===l.n)r.push([c,l]);else if((D?"production":void 0)!=="production"&&t.has(c))throw new Error("[Bug] invalidated atom exists");d.add(c),u.pop();continue}_.add(c);for(const E of ee(c,l,n))_.has(E)||u.push(E)}for(let c=r.length-1;c>=0;--c){const[l,E]=r[c];let A=!1;for(const R of E.d.keys())if(R!==l&&o.has(R)){A=!0;break}A&&(I(l),O(l)),t.delete(l)}}),I=p[3]||(r=>{var _;const d=S(r);if(m(d)&&(n.has(r)&&t.get(r)!==d.n||Array.from(d.d).every(([b,V])=>I(b).n===V)))return d;d.d.clear();let u=!0;const c=()=>{n.has(r)&&(O(r),g(),y())},l=b=>{var V;if(k(r,b)){const Z=S(b);if(!m(Z))if(B(b))G(b,b.init,S);else throw new Error("no atom init");return x(Z)}const $=I(b);try{return x($)}finally{d.d.set(b,$.n),H(d.v)&&se(r,d.v,$),(V=n.get(b))==null||V.t.add(r),u||c()}};let E,A;const R={get signal(){return E||(E=new AbortController),E.signal},get setSelf(){return(D?"production":void 0)!=="production"&&!C(r)&&console.warn("setSelf function cannot be used with read-only atom"),!A&&C(r)&&(A=(...b)=>{if((D?"production":void 0)!=="production"&&u&&console.warn("setSelf function cannot be called in sync"),!u)try{return T(r,...b)}finally{g(),y()}}),A}},z=d.n;try{const b=h(r,l,R);return G(r,b,S),j(b)&&(ie(b,()=>E?.abort()),b.then(c,c)),d}catch(b){return delete d.v,d.e=b,++d.n,d}finally{u=!1,z!==d.n&&t.get(r)===z&&(t.set(r,d.n),o.add(r),(_=f.c)==null||_.call(f,r))}}),M=p[4]||(r=>{const _=[r];for(;_.length;){const d=_.pop(),u=S(d);for(const c of ee(d,u,n)){const l=S(c);t.set(c,l.n),_.push(c)}}}),T=p[5]||((r,..._)=>{let d=!0;const u=l=>x(I(l)),c=(l,...E)=>{var A;const R=S(l);try{if(k(r,l)){if(!B(l))throw new Error("atom not writable");const z=R.n,b=E[0];G(l,b,S),O(l),z!==R.n&&(o.add(l),(A=f.c)==null||A.call(f,l),M(l));return}else return T(l,...E)}finally{d||(g(),y())}};try{return w(r,u,c,..._)}finally{d=!1}}),O=p[6]||(r=>{var _;const d=S(r),u=n.get(r);if(u&&!H(d.v)){for(const[c,l]of d.d)if(!u.d.has(c)){const E=S(c);N(c).t.add(r),u.d.add(c),l!==E.n&&(o.add(c),(_=f.c)==null||_.call(f,c),M(c))}for(const c of u.d||[])if(!d.d.has(c)){u.d.delete(c);const l=W(c);l?.t.delete(r)}}}),N=p[7]||(r=>{var _;const d=S(r);let u=n.get(r);if(!u){I(r);for(const c of d.d.keys())N(c).t.add(r);if(u={l:new Set,d:new Set(d.d.keys()),t:new Set},n.set(r,u),(_=f.m)==null||_.call(f,r),C(r)){const c=()=>{let l=!0;const E=(...A)=>{try{return T(r,...A)}finally{l||(g(),y())}};try{const A=v(r,E);A&&(u.u=()=>{l=!0;try{A()}finally{l=!1}})}finally{l=!1}};i.add(c)}}return u}),W=p[8]||(r=>{var _;const d=S(r);let u=n.get(r);if(u&&!u.l.size&&!Array.from(u.t).some(c=>{var l;return(l=n.get(c))==null?void 0:l.d.has(r)})){u.u&&a.add(u.u),u=void 0,n.delete(r),(_=f.u)==null||_.call(f,r);for(const c of d.d.keys()){const l=W(c);l?.t.delete(r)}return}return u}),ae=[e,n,t,o,i,a,f,h,w,s,v,S,y,g,I,M,T,O,N,W],U={get:r=>x(I(r)),set:(r,..._)=>{try{return T(r,..._)}finally{g(),y()}},sub:(r,_)=>{const u=N(r).l;return u.add(_),y(),()=>{u.delete(_),W(r),y()}}};return Object.defineProperty(U,he,{value:ae}),U},ce=Se,pe=we,te=ie,X={};let ye=0;function ne(e,n){const t=`atom${++ye}`,o={toString(){return(X?"production":void 0)!=="production"&&this.debugLabel?t+":"+this.debugLabel:t}};return typeof e=="function"?o.read=e:(o.init=e,o.read=be,o.write=ge),n&&(o.write=n),o}function be(e){return e(this)}function ge(e,n,t){return n(this,typeof t=="function"?t(e(this)):t)}const Ee=()=>{let e=0;const n=pe({}),t=new WeakMap,o=new WeakMap,i=ce(t,o,void 0,void 0,void 0,void 0,n,void 0,(h,w,s,...v)=>e?s(h,...v):h.write(w,s,...v)),a=new Set;return n.m.add(void 0,h=>{a.add(h);const w=t.get(h);w.m=o.get(h)}),n.u.add(void 0,h=>{a.delete(h);const w=t.get(h);delete w.m}),Object.assign(i,{dev4_get_internal_weak_map:()=>(console.log("Deprecated: Use devstore from the devtools library"),t),dev4_get_mounted_atoms:()=>a,dev4_restore_atoms:h=>{const w={read:()=>null,write:(s,v)=>{++e;try{for(const[p,S]of h)"init"in p&&v(p,S)}finally{--e}}};i.set(w)}})};function ue(){return(X?"production":void 0)!=="production"?Ee():ce()}let L;function Ae(){return L||(L=ue(),(X?"production":void 0)!=="production"&&(globalThis.__JOTAI_DEFAULT_STORE__||(globalThis.__JOTAI_DEFAULT_STORE__=L),globalThis.__JOTAI_DEFAULT_STORE__!==L&&console.warn("Detected multiple Jotai instances. It may cause unexpected behavior with the default store. https://github.com/pmndrs/jotai/discussions/2044"))),L}const Ie={},le=P.createContext(void 0);function de(e){return P.useContext(le)||Ae()}function We({children:e,store:n}){const t=P.useRef(void 0);return!n&&!t.current&&(t.current=ue()),P.createElement(le.Provider,{value:n||t.current},e)}const F=e=>typeof e?.then=="function",Q=e=>{e.status||(e.status="pending",e.then(n=>{e.status="fulfilled",e.value=n},n=>{e.status="rejected",e.reason=n}))},Pe=oe.use||(e=>{if(e.status==="pending")throw e;if(e.status==="fulfilled")return e.value;throw e.status==="rejected"?e.reason:(Q(e),e)}),q=new WeakMap,re=(e,n)=>{let t=q.get(e);return t||(t=new Promise((o,i)=>{let a=e;const f=s=>v=>{a===s&&o(v)},h=s=>v=>{a===s&&i(v)},w=()=>{try{const s=n();F(s)?(q.set(s,t),a=s,s.then(f(s),h(s)),te(s,w)):o(s)}catch(s){i(s)}};e.then(f(e),h(e)),te(e,w)}),q.set(e,t)),t};function Re(e,n){const{delay:t,unstable_promiseStatus:o=!oe.use}={},i=de(),[[a,f,h],w]=P.useReducer(v=>{const p=i.get(e);return Object.is(v[0],p)&&v[1]===i&&v[2]===e?v:[p,i,e]},void 0,()=>[i.get(e),i,e]);let s=a;if((f!==i||h!==e)&&(w(),s=i.get(e)),P.useEffect(()=>{const v=i.sub(e,()=>{if(o)try{const p=i.get(e);F(p)&&Q(re(p,()=>i.get(e)))}catch{}if(typeof t=="number"){setTimeout(w,t);return}w()});return w(),v},[i,e,t,o]),P.useDebugValue(s),F(s)){const v=re(s,()=>i.get(e));return o&&Q(v),Pe(v)}return s}function Te(e,n){const t=de();return P.useCallback((...i)=>{if((Ie?"production":void 0)!=="production"&&!("write"in e))throw new Error("not writable atom");return t.set(e,...i)},[t,e])}function ze(e,n){return[Re(e),Te(e)]}const Y={},Le=Symbol((Y?"production":void 0)!=="production"?"RESET":""),fe=e=>typeof e?.then=="function";function De(e=()=>{try{return window.localStorage}catch(t){(Y?"production":void 0)!=="production"&&typeof window<"u"&&console.warn(t);return}},n){var t;let o,i;const a={getItem:(w,s)=>{var v,p;const S=g=>{if(g=g||"",o!==g){try{i=JSON.parse(g,n?.reviver)}catch{return s}o=g}return i},y=(p=(v=e())==null?void 0:v.getItem(w))!=null?p:null;return fe(y)?y.then(S):S(y)},setItem:(w,s)=>{var v;return(v=e())==null?void 0:v.setItem(w,JSON.stringify(s,void 0))},removeItem:w=>{var s;return(s=e())==null?void 0:s.removeItem(w)}},f=w=>(s,v,p)=>w(s,S=>{let y;try{y=JSON.parse(S||"")}catch{y=p}v(y)});let h;try{h=(t=e())==null?void 0:t.subscribe}catch{}return!h&&typeof window<"u"&&typeof window.addEventListener=="function"&&window.Storage&&(h=(w,s)=>{if(!(e()instanceof window.Storage))return()=>{};const v=p=>{p.storageArea===e()&&p.key===w&&s(p.newValue)};return window.addEventListener("storage",v),()=>{window.removeEventListener("storage",v)}}),h&&(a.subscribe=f(h)),a}const Oe=De();function Ve(e,n,t=Oe,o){const i=ne(n);return(Y?"production":void 0)!=="production"&&(i.debugPrivate=!0),i.onMount=f=>{f(t.getItem(e,n));let h;return t.subscribe&&(h=t.subscribe(e,f,n)),h},ne(f=>f(i),(f,h,w)=>{const s=typeof w=="function"?w(f(i)):w;return s===Le?(h(i,n),t.removeItem(e)):fe(s)?s.then(v=>(h(i,v),t.setItem(e,v))):(h(i,s),t.setItem(e,s))})}export{We as P,ne as a,Te as b,Ve as c,Re as d,ze as u};
